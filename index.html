<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Simple Pac-Man Game</title>
  <style>
    body {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      height: 100vh;
      margin: 0;
      background-color: #000;
      font-family: Arial, sans-serif;
      overflow: hidden;
    }

    #game-container {
      position: relative;
      width: 560px;
      height: 620px;
      border: 4px solid #00F;
      background-color: #000;
    }

    #score {
      color: white;
      font-size: 24px;
      margin-bottom: 10px;
    }

    .pacman {
      position: absolute;
      width: 30px;
      height: 30px;
      border-radius: 50%;
      z-index: 2;
      background-color: transparent;
      background-image: url('icon/wpface.png');
      background-size: cover;
    }

    .ghost {
      position: absolute;
      width: 30px;
      height: 30px;
      background-color: transparent;
      background-image: none; /* Set by JavaScript */
      background-size: cover;
      z-index: 1;
    }

    .pellet {
      position: absolute;
      width: 10px;
      height: 10px;
      background-color: transparent;
      background-image: url('icon/book.png');
      background-size: cover;
    }

    .wall {
      position: absolute;
      background-color: #00F;
    }

    #game-over, #game-start {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      color: white;
      font-size: 36px;
      text-align: center;
      background-color: rgba(0, 0, 0, 0.8);
      padding: 20px;
      border-radius: 10px;
      display: none;
    }

    button {
      background-color: #FFFF00;
      border: none;
      padding: 10px 20px;
      font-size: 18px;
      margin-top: 20px;
      cursor: pointer;
      border-radius: 5px;
    }
  </style>
</head>
<body>
  <div id="score">Score: 0</div>
  <div id="game-container">
    <div id="game-start">
      <h2>PAC-MAN</h2>
      <p>Use arrow keys to move</p>
      <button id="start-button">Start Game</button>
    </div>
    <div id="game-over">
      <h2>GAME OVER</h2>
      <p id="final-score">Your score: 0</p>
      <button id="restart-button">Play Again</button>
    </div>
  </div>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
      // Game variables
      const gameContainer = document.getElementById('game-container');
      const scoreDisplay = document.getElementById('score');
      const gameOverScreen = document.getElementById('game-over');
      const gameStartScreen = document.getElementById('game-start');
      const finalScoreDisplay = document.getElementById('final-score');
      const startButton = document.getElementById('start-button');
      const restartButton = document.getElementById('restart-button');

      let score = 0;
      let pacman;
      let ghosts = [];
      let pellets = [];
      let walls = [];
      let gameRunning = false;
      let gameInterval;

      const containerWidth = 560;
      const containerHeight = 620;
      const pacmanSize = 30;
      const pelletSize = 10;
      const ghostSize = 30;

      let direction = 'right';
      let nextDirection = 'right';
      const speed = 3;
      const ghostSpeed = 2;

      startButton.addEventListener('click', startGame);
      restartButton.addEventListener('click', startGame);

      gameStartScreen.style.display = 'block';

      function startGame() {
        gameContainer.innerHTML = '';
        gameContainer.appendChild(gameOverScreen);
        gameContainer.appendChild(gameStartScreen);

        gameOverScreen.style.display = 'none';
        gameStartScreen.style.display = 'none';

        score = 0;
        scoreDisplay.textContent = `Score: ${score}`;
        ghosts = [];
        pellets = [];
        walls = [];
        gameRunning = true;

        pacman = document.createElement('div');
        pacman.className = 'pacman';
        pacman.style.left = '260px'; // Centered near bottom
        pacman.style.top = '500px';
        gameContainer.appendChild(pacman);

        createWalls();
        createPellets();
        createGhosts();

        if (gameInterval) clearInterval(gameInterval);
        gameInterval = setInterval(updateGame, 30);

        document.addEventListener('keydown', handleKeyPress);
      }

      function createWalls() {
        const wallThickness = 10;

        // Outer border walls
        createWall(0, 0, containerWidth, wallThickness); // Top
        createWall(0, containerHeight - wallThickness, containerWidth, wallThickness); // Bottom
        createWall(0, 0, wallThickness, containerHeight); // Left
        createWall(containerWidth - wallThickness, 0, wallThickness, containerHeight); // Right

        // Maze layout inspired by original Pac-Man, scaled to 560x620px
        // Top section
        createWall(50, 50, 460, wallThickness); // Top horizontal
        createWall(50, 50, wallThickness, 100); // Left vertical from top
        createWall(510, 50, wallThickness, 100); // Right vertical from top
        createWall(100, 100, 80, wallThickness); // Left top short horizontal
        createWall(380, 100, 80, wallThickness); // Right top short horizontal

        // Tunnels (40px wide, single-file for 30px entities)
        createWall(0, 240, 140, wallThickness); // Left tunnel top wall
        createWall(0, 280, 140, wallThickness); // Left tunnel bottom wall
        createWall(420, 240, 140, wallThickness); // Right tunnel top wall
        createWall(420, 280, 140, wallThickness); // Right tunnel bottom wall

        // Ghost house (centered, with entrance)
        createWall(210, 200, 140, wallThickness); // Top of ghost house
        createWall(210, 200, wallThickness, 80); // Left wall of ghost house
        createWall(350, 200, wallThickness, 80); // Right wall of ghost house
        createWall(210, 280, 70, wallThickness); // Left bottom of ghost house
        createWall(290, 280, 60, wallThickness); // Right bottom (gap in middle)

        // Middle section
        createWall(50, 340, 100, wallThickness); // Left lower horizontal
        createWall(410, 340, 100, wallThickness); // Right lower horizontal
        createWall(50, 340, wallThickness, 100); // Left vertical down
        createWall(510, 340, wallThickness, 100); // Right vertical down
        createWall(200, 340, 160, wallThickness); // Middle horizontal
        createWall(200, 340, wallThickness, 60); // Left vertical from middle
        createWall(360, 340, wallThickness, 60); // Right vertical from middle

        // Bottom section
        createWall(100, 440, 80, wallThickness); // Left bottom short horizontal
        createWall(380, 440, 80, wallThickness); // Right bottom short horizontal
        createWall(100, 440, wallThickness, 70); // Left vertical to near bottom
        createWall(460, 440, wallThickness, 70); // Right vertical to near bottom
        createWall(50, 510, 180, wallThickness); // Left bottom horizontal
        createWall(330, 510, 180, wallThickness); // Right bottom horizontal
        createWall(50, 510, wallThickness, 100); // Left bottom vertical
        createWall(510, 510, wallThickness, 100); // Right bottom vertical

        // Additional complexity (inner walls)
        createWall(150, 150, 80, wallThickness); // Left inner horizontal
        createWall(330, 150, 80, wallThickness); // Right inner horizontal
        createWall(250, 100, wallThickness, 80); // Center vertical above ghost house
        createWall(310, 100, wallThickness, 80); // Parallel to center
        createWall(150, 400, 80, wallThickness); // Left lower inner horizontal
        createWall(330, 400, 80, wallThickness); // Right lower inner horizontal
      }

      function createWall(x, y, width, height) {
        const wall = document.createElement('div');
        wall.className = 'wall';
        wall.style.left = `${x}px`;
        wall.style.top = `${y}px`;
        wall.style.width = `${width}px`;
        wall.style.height = `${height}px`;
        gameContainer.appendChild(wall);
        walls.push({ x, y, width, height });
      }

      function createPellets() {
        const gridSize = 40;
        for (let x = 30; x < containerWidth; x += gridSize) {
          for (let y = 30; y < containerHeight; y += gridSize) {
            if (!isCollidingWithWalls(x, y, pelletSize, pelletSize)) {
              createPellet(x, y);
            }
          }
        }
      }

      function createPellet(x, y) {
        const pellet = document.createElement('div');
        pellet.className = 'pellet';
        pellet.style.left = `${x}px`;
        pellet.style.top = `${y}px`;
        gameContainer.appendChild(pellet);
        pellets.push({ x, y, element: pellet, eaten: false });
      }

      function createGhosts() {
        const positions = [
          { x: 230, y: 220 },
          { x: 270, y: 220 },
          { x: 310, y: 220 },
          { x: 270, y: 250 }
        ];

        for (let i = 0; i < 4; i++) {
          const ghost = document.createElement('div');
          ghost.className = 'ghost';
          ghost.style.left = `${positions[i].x}px`;
          ghost.style.top = `${positions[i].y}px`;
          ghost.style.backgroundImage = `url('icon/ghost${i+1}.png')`;
          gameContainer.appendChild(ghost);

          ghosts.push({
            x: positions[i].x,
            y: positions[i].y,
            element: ghost,
            direction: getRandomDirection()
          });
        }
      }

      function getRandomDirection() {
        const directions = ['up', 'down', 'left', 'right'];
        return directions[Math.floor(Math.random() * directions.length)];
      }

      function updateGame() {
        if (!gameRunning) return;
        movePacman();
        checkPelletCollisions();
        moveGhosts();
        checkGhostCollisions();
        if (pellets.every(pellet => pellet.eaten)) {
          gameOver(true);
        }
      }

      function movePacman() {
        let newX = parseInt(pacman.style.left);
        let newY = parseInt(pacman.style.top);

        if (nextDirection !== direction) {
          let testX = newX;
          let testY = newY;
          switch (nextDirection) {
            case 'up': testY -= speed; break;
            case 'down': testY += speed; break;
            case 'left': testX -= speed; break;
            case 'right': testX += speed; break;
          }
          if (!isCollidingWithWalls(testX, testY, pacmanSize, pacmanSize)) {
            direction = nextDirection;
          }
        }

        switch (direction) {
          case 'up': newY -= speed; break;
          case 'down': newY += speed; break;
          case 'left': newX -= speed; break;
          case 'right': newX += speed; break;
        }

        if (!isCollidingWithWalls(newX, newY, pacmanSize, pacmanSize)) {
          pacman.style.left = `${newX}px`;
          pacman.style.top = `${newY}px`;
        }
      }

      function isCollidingWithWalls(x, y, width, height) {
        for (const wall of walls) {
          if (
            x < wall.x + wall.width &&
            x + width > wall.x &&
            y < wall.y + wall.height &&
            y + height > wall.y
          ) {
            return true;
          }
        }
        return false;
      }

      function checkPelletCollisions() {
        const pacmanX = parseInt(pacman.style.left) + pacmanSize / 2;
        const pacmanY = parseInt(pacman.style.top) + pacmanSize / 2;

        for (const pellet of pellets) {
          if (!pellet.eaten) {
            const pelletX = pellet.x + pelletSize / 2;
            const pelletY = pellet.y + pelletSize / 2;
            const distance = Math.sqrt(
              Math.pow(pacmanX - pelletX, 2) + Math.pow(pacmanY - pelletY, 2)
            );
            if (distance < (pacmanSize / 2) + (pelletSize / 2)) {
              pellet.eaten = true;
              pellet.element.style.display = 'none';
              score += 10;
              scoreDisplay.textContent = `Score: ${score}`;
            }
          }
        }
      }

      function moveGhosts() {
        for (const ghost of ghosts) {
          let newX = ghost.x;
          let newY = ghost.y;

          if (Math.random() < 0.02) {
            ghost.direction = getRandomDirection();
          }

          switch (ghost.direction) {
            case 'up': newY -= ghostSpeed; break;
            case 'down': newY += ghostSpeed; break;
            case 'left': newX -= ghostSpeed; break;
            case 'right': newX += ghostSpeed; break;
          }

          if (!isCollidingWithWalls(newX, newY, ghostSize, ghostSize)) {
            ghost.x = newX;
            ghost.y = newY;
            ghost.element.style.left = `${newX}px`;
            ghost.element.style.top = `${newY}px`;
          } else {
            ghost.direction = getRandomDirection();
          }
        }
      }

      function checkGhostCollisions() {
        const pacmanX = parseInt(pacman.style.left) + pacmanSize / 2;
        const pacmanY = parseInt(pacman.style.top) + pacmanSize / 2;

        for (const ghost of ghosts) {
          const ghostX = ghost.x + ghostSize / 2;
          const ghostY = ghost.y + ghostSize / 2;
          const distance = Math.sqrt(
            Math.pow(pacmanX - ghostX, 2) + Math.pow(pacmanY - ghostY, 2)
          );
          if (distance < (pacmanSize / 2) + (ghostSize / 2)) {
            gameOver(false);
            return;
          }
        }
      }

      function gameOver(win) {
        gameRunning = false;
        clearInterval(gameInterval);
        finalScoreDisplay.textContent = `Your score: ${score}`;
        gameOverScreen.style.display = 'block';
        document.querySelector('#game-over h2').textContent = win ? 'YOU WIN!' : 'GAME OVER';
      }

      function handleKeyPress(e) {
        switch (e.key) {
          case 'ArrowUp': nextDirection = 'up'; break;
          case 'ArrowDown': nextDirection = 'down'; break;
          case 'ArrowLeft': nextDirection = 'left'; break;
          case 'ArrowRight': nextDirection = 'right'; break;
        }
      }
    });
  </script>
</body>
</html>
